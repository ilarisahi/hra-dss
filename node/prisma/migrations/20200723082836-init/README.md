# Migration `20200723082836-init`

This migration has been generated by Ilari Sahi at 7/23/2020, 8:28:36 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Role" AS ENUM ('EMPLOYEE', 'MANAGER', 'ADMIN');

CREATE TABLE "public"."User" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"email" text  NOT NULL ,"hash" text  NOT NULL ,"id" SERIAL,"name" text  NOT NULL ,"role" "Role" NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Project" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"createdById" integer  NOT NULL ,"description" text  NOT NULL ,"draft" boolean  NOT NULL ,"endDate" timestamp(3)   ,"id" SERIAL,"keywords" text  NOT NULL ,"name" text  NOT NULL ,"startDate" timestamp(3)   ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."ProjectPosition" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"description" text  NOT NULL ,"endDate" timestamp(3)   ,"id" SERIAL,"keywords" text  NOT NULL ,"name" text  NOT NULL ,"projectId" integer  NOT NULL ,"startDate" timestamp(3)   ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."PositionSkill" (
"compulsory" boolean  NOT NULL DEFAULT false,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"level" Decimal(65,30)  NOT NULL ,"name" text  NOT NULL ,"positionId" integer  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Employee" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"email" text  NOT NULL ,"id" SERIAL,"keywords" text  NOT NULL ,"name" text  NOT NULL ,"preferences" text  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Allocation" (
"capacity" Decimal(65,30)  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"draft" boolean  NOT NULL ,"employeeId" integer  NOT NULL ,"endDate" timestamp(3)  NOT NULL ,"id" SERIAL,"position" text  NOT NULL ,"projectId" integer  NOT NULL ,"startDate" timestamp(3)  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."EmployeeSkill" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"employeeId" integer  NOT NULL ,"id" SERIAL,"level" Decimal(65,30)  NOT NULL ,"name" text  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."EmployeeExperience" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"customer" text  NOT NULL ,"description" text  NOT NULL ,"employeeId" integer  NOT NULL ,"endDate" timestamp(3)  NOT NULL ,"id" SERIAL,"keywords" text  NOT NULL ,"name" text  NOT NULL ,"position" text  NOT NULL ,"skills" text []  ,"startDate" timestamp(3)  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "Employee.email" ON "public"."Employee"("email")

ALTER TABLE "public"."Project" ADD FOREIGN KEY ("createdById")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."ProjectPosition" ADD FOREIGN KEY ("projectId")REFERENCES "public"."Project"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."PositionSkill" ADD FOREIGN KEY ("positionId")REFERENCES "public"."ProjectPosition"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Allocation" ADD FOREIGN KEY ("employeeId")REFERENCES "public"."Employee"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Allocation" ADD FOREIGN KEY ("projectId")REFERENCES "public"."Project"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."EmployeeSkill" ADD FOREIGN KEY ("employeeId")REFERENCES "public"."Employee"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."EmployeeExperience" ADD FOREIGN KEY ("employeeId")REFERENCES "public"."Employee"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200723082836-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,119 @@
+datasource db {
+    provider = "postgresql"
+    url = "***"
+}
+
+generator client {
+    provider = "prisma-client-js"
+}
+
+enum Role {
+    EMPLOYEE
+    MANAGER
+    ADMIN
+}
+
+model User {
+    id Int @id @default(autoincrement())
+    name String
+    email String @unique
+    role Role
+    hash String
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model Project {
+    id Int @id @default(autoincrement())
+    createdBy User @relation(fields: [createdById], references: [id])
+    createdById Int
+    positions ProjectPosition[]
+    allocations Allocation[]
+    name String
+    description String
+    startDate DateTime?
+    endDate DateTime?
+    draft Boolean
+    keywords String
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model ProjectPosition {
+    id Int @id @default(autoincrement())
+    project Project @relation(fields: [projectId], references: [id])
+    projectId Int
+    skills PositionSkill[]
+    name String
+    description String
+    startDate DateTime?
+    endDate DateTime?
+    keywords String
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model PositionSkill {
+    id Int @id @default(autoincrement())
+    position ProjectPosition @relation(fields: [positionId], references: [id])
+    positionId Int
+    name String
+    level Float
+    compulsory Boolean @default(false)
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model Employee {
+    id Int @id @default(autoincrement())
+    skills EmployeeSkill[]
+    experience EmployeeExperience[]
+    allocations Allocation[]
+    name String
+    email String @unique
+    preferences String
+    keywords String
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model Allocation {
+    id Int @id @default(autoincrement())
+    employee Employee @relation(fields: [employeeId], references: [id])
+    employeeId Int
+    project Project @relation(fields: [projectId], references: [id])
+    projectId Int
+    position String
+    startDate DateTime
+    endDate DateTime
+    capacity Float
+    draft Boolean
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model EmployeeSkill {
+    id Int @id @default(autoincrement())
+    employee Employee @relation(fields: [employeeId], references: [id])
+    employeeId Int
+    name String
+    level Float
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
+
+model EmployeeExperience {
+    id Int @id @default(autoincrement())
+    employee Employee @relation(fields: [employeeId], references: [id])
+    employeeId Int
+    name String
+    customer String
+    position String
+    description String
+    skills String[]
+    startDate DateTime
+    endDate DateTime
+    keywords String
+    createdAt DateTime @default(now())
+    updatedAt DateTime @updatedAt
+}
```


